<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Music App</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
      integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="container">
      <div class="music-app">
        <div class="music-content">
          <div class="music-album">
            <img
              class="album-cover-image"
              src="https://images.unsplash.com/photo-1549937915-3dd443a3583f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=701&q=80"
            />
            <p class="song-title">Better together</p>
            <p class="artist">Kathyrn</p>
          </div>
          <div class="music-controls">
            <div id="pre_event"><i class="fas fa-step-backward"></i></div>
            <div id="play_event">
              <i class="fas fa-play-circle"></i>
            </div>
            <div id="next_event"><i class="fas fa-step-forward"></i></div>
          </div>
          <audio controls id="audio" class="hidden">
            <source src="./songs/bensound-buddy.mp3" type="audio/mpeg" />
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>
    </div>
    <script>
      window.onload = () => {
        const music = new MusicPlayer();
        let play_event = document.querySelector("#play_event");
        play_event.addEventListener("click", () => {
          music.playAndPause();
        });
        let pre_event = document.querySelector("#pre_event");
        pre_event.addEventListener("click", () => {
          music.pre();
        });
        let next_event = document.querySelector("#next_event");
        next_event.addEventListener("click", () => {
          music.next();
        });
      };

      const data = [
        {
          artist: "Benjamin Tissot (also known as Bensound)",
          songTitle: "Buddy",
          song: "./songs/bensound-buddy.mp3",
          coverImage:
            "https://images.unsplash.com/photo-1549937915-3dd443a3583f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=701&q=80",
        },
        {
          artist: "Benjamin Tissot (also known as Bensound)",
          songTitle: "Creative minds",
          song: "./songs/bensound-creativeminds.mp3",
          coverImage:
            "https://images.unsplash.com/photo-1608403315268-764ed28bcb28?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80",
        },
        {
          artist: "Benjamin Tissot (also known as Bensound)",
          songTitle: "Cute",
          song: "./songs/bensound-cute.mp3",
          coverImage:
            "https://images.unsplash.com/photo-1475090169767-40ed8d18f67d?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1489&q=80",
        },
      ];

      class MusicPlayer {
        audio;
        toggle = true;
        currentIndex = 0;
        artist;

        constructor() {
          this.audio = document.getElementById("audio");
          this.songTitle = document.querySelector(".song-title");
          this.coverPicture = document.querySelector(".album-cover-image");
          this.artist = document.querySelector(".artist");
          this.setCurrentSong();
          this.setCurrentElements();
        }
        pre() {
          this.currentIndex--;
          if (this.currentIndex < 0) {
            this.currentIndex = data.length - 1;
          }
          this.setCurrentSong();
          this.forcePlay();
        }
        next() {
          this.currentIndex++;
          if (this.currentIndex > data.length - 1) {
            this.currentIndex = 0;
          }
          this.setCurrentSong();
          this.forcePlay();
        }
        setCurrentSong() {
          this.audio.setAttribute("src", data[this.currentIndex].song);
        }
        forcePlay() {
          this.toggle = true;
          this.playAndPause();
        }

        playAndPause() {
          if (this.toggle) {
            this.audio.play();
            this.toggle = false;
            HelperElement.setupPlayElement();
            this.rotateCoverPicture();
          } else {
            this.audio.pause();
            this.toggle = true;
            HelperElement.setupPauseElement();
            this.stopCoverPicture();
          }
          this.setCurrentElements();
        }
        setCurrentElements() {
          this.coverPicture.setAttribute(
            "src",
            data[this.currentIndex].coverImage
          );
          this.artist.innerHTML = data[this.currentIndex].artist;
          this.songTitle.innerHTML = data[this.currentIndex].songTitle;
        }
        rotateCoverPicture() {
          this.coverPicture.style.animation =
            "rotateFrame 4s linear infinite running";
        }
        stopCoverPicture() {
          this.coverPicture.style.animationPlayState = "paused";
        }
      }
      class HelperElement {
        static setupPlayElement() {
          let play_event = document.querySelector("#play_event");
          play_event.innerHTML = "";

          play_event.append(
            HelperElement.createPauseOrPlayElement("fa-pause-circle")
          );
        }
        static setupPauseElement() {
          let play_event = document.querySelector("#play_event");
          play_event.innerHTML = "";
          play_event.append(
            HelperElement.createPauseOrPlayElement("fa-play-circle")
          );
        }

        static createPauseOrPlayElement(playlogo) {
          let pause = document.createElement("i");
          pause.classList.add("fas", playlogo);
          return pause;
        }
      }
    </script>
  </body>
</html>
